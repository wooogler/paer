{
  "$schema": "https://railway.app/railway.schema.json",
  "build": {
    "builder": "NIXPACKS",
    "buildCommand": "pnpm install && pnpm build:shared && pnpm build:server && find . -name 'index.js'"
  },
  "deploy": {
    "numReplicas": 1,
    "startCommand": "cd /app && NODE_ENV=production node $(find server -name 'index.js' | grep -v 'node_modules' | head -1)",
    "sleepApplication": false,
    "restartPolicyType": "ON_FAILURE",
    "restartPolicyMaxRetries": 10
  }
}
